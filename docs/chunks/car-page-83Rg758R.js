import{a as d,b as _,j as e,r as h,w,c as C}from"../entry/index-ARn7AJjJ.js";import{u as p,d as D,a as v,L as R,e as I}from"./use-analitics-BcUOdrjJ.js";import{L as k}from"./loader-D2OY5_9h.js";import{f as G}from"./find-img-C8T6visu.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="95558087-919e-4c95-8cc0-edfbeb1dbb71",s._sentryDebugIdIdentifier="sentry-dbid-95558087-919e-4c95-8cc0-edfbeb1dbb71")}catch{}})();const $="_wrapper_5dfp2_1",F="_carNumber_5dfp2_11",j={wrapper:$,carNumber:F},S=["Поставку отказались принимать  ","Не успел подъехать на ворота","Пришлось долго ждать в очереди","Ворота были заняты","Приёмщик требовал взятку"],T=["Быстро подошла очередь","Быстро разгрузили","Вежливый приемщик"],L={bad:S,good:T,"":[]},q="_rating__items_18sh1_1",E="_rating__item_18sh1_1",H="_unloaded_18sh1_103",M="_rating__field_18sh1_119",B="_rating__validate_18sh1_121",z="_rating__require_18sh1_173",V="_rating__button_18sh1_183",m={rating__items:q,rating__item:E,unloaded:H,rating__field:M,rating__validate:B,rating__require:z,rating__button:V},P=()=>{const{ratingType:s,ratingItems:a,setRecall:r,setRatingItems:t}=d(_(n=>({ratingType:n.ratingType,ratingItems:n.ratingItems,setRecall:n.setRecall,setRatingItems:n.setRatingItems}))),c=n=>!!a.find(i=>i==n+1),o=n=>{n.target.checked?t([...a,Number(n.target.id)+1]):t(a.filter(i=>i!==Number(n.target.id)+1))};return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:m.unloaded,children:s==="bad"?"Что было плохо?":"Что было хорошо?"}),e.jsx("form",{className:m.rating__items,children:L[s].map((n,i)=>e.jsxs("div",{className:m.rating__item,children:[e.jsx("input",{checked:c(i),onChange:o,id:`${i}`,type:"checkbox"}),e.jsx("label",{htmlFor:`${i}`,children:n}),e.jsx("span",{children:"✓"})]},i))}),e.jsx("textarea",{className:m.rating__field,placeholder:"Дополнения, если есть,что добавить"}),e.jsx("p",{className:m.unloaded,children:"Для порядка"}),e.jsx("input",{className:m.rating__validate,placeholder:"Номер поставки или ФИО"}),e.jsx("p",{className:m.rating__require,children:"Введите номер поставкиили ФИО полностью, чтобы мы могли убедиться, что отзыв настоящий"}),e.jsx("button",{onClick:()=>r("sent"),className:m.rating__button,children:"Отправить"})]})},Q="_rating__stars_1fkgu_1",W={rating__stars:Q},A=()=>{const{changeStars:s}=d(_(a=>({changeStars:a.changeStars})));return e.jsxs("form",{onChange:s,className:W.rating__stars,children:[e.jsx("input",{id:"star-5",type:"radio",name:"stars",value:"5"}),e.jsx("label",{htmlFor:"star-5"}),e.jsx("input",{id:"star-4",type:"radio",name:"stars",value:"4"}),e.jsx("label",{htmlFor:"star-4"}),e.jsx("input",{id:"star-3",type:"radio",name:"stars",value:"3"}),e.jsx("label",{htmlFor:"star-3"}),e.jsx("input",{id:"star-2",type:"radio",name:"stars",value:"2"}),e.jsx("label",{htmlFor:"star-2"}),e.jsx("input",{id:"star-1",type:"radio",name:"stars",value:"1"}),e.jsx("label",{htmlFor:"star-1"})]})},U="_unloaded_1y99i_1",J="_unchosen_1y99i_15",f={unloaded:U,unchosen:J},K=()=>{const{stars:s,setStars:a,setRecall:r}=d(_(t=>({stars:t.stars,setStars:t.setStars,setRecall:t.setRecall})));return h.useEffect(()=>()=>{a(0)},[a,r]),e.jsxs(e.Fragment,{children:[e.jsx("p",{className:f.unloaded,children:"Как прошла разгрузка?"}),e.jsx(A,{}),s?e.jsx(P,{}):e.jsx("div",{className:f.unchosen,children:"Оцените, а потом добавите детали, если захотите"})]})},N=(s,a=1)=>{var c;const t=(c=w.find(o=>s.warehouseName.toLowerCase().includes(o.name.toLowerCase())).gates)==null?void 0:c.find(o=>o.from.n<=Number(s.gateName)&&o.to.n>=Number(s.gateName));if(t){const o=(t.from.x+(t.to.x-t.from.x)*(Number(s.gateName)-t.from.n)/(t.to.n-t.from.n)-20)*a,n=(t.from.y+(t.to.y-t.from.y)*(Number(s.gateName)-t.from.n)/(t.to.n-t.from.n)-20)*a;return{x:o,y:n}}else return{x:-100,y:-100}},O=()=>{const{carData:s,setGatesCoordinates:a}=d(_(t=>({carData:t.carData,setGatesCoordinates:t.setGatesCoordinates}))),r=h.useRef(null);return h.useEffect(()=>{const t=()=>{if(s&&r.current){const c=r.current;a(N(s,c.width/393))}};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[s,a]),r},X="_schema_1kp9o_1",Y="_schema__text_1kp9o_9",Z="_schema__img_1kp9o_23",ee="_schema__point_1kp9o_55",se="_notice_1kp9o_73",g={schema:X,schema__text:Y,schema__img:Z,schema__point:ee,notice:se},te=()=>{const{carData:s,gatesCoordinates:a,setGatesCoordinates:r}=d(_(l=>({carData:l.carData,gatesCoordinates:l.gatesCoordinates,setGatesCoordinates:l.setGatesCoordinates}))),{t}=p(),c=D(s),o=c&&G(c),n=O(),i=l=>{const y=l.target;s&&r(N(s,y.width/393))};return e.jsxs("div",{className:g.schema,children:[e.jsx("p",{className:g.schema__text,children:t("where-are-gates")}),e.jsxs("div",{className:g.schema__img,children:[e.jsx("img",{alt:s.carNumber,onLoad:i,ref:n,src:o}),e.jsx("span",{className:g.schema__point,style:{display:a.y===-100?"none":"block",top:a.y,left:a.x}})]}),s.gateName&&e.jsxs("div",{className:g.notice,children:[e.jsx("strong",{children:t("notice-strong")}),t("notice-normal")]})]})},ae="_unloaded_o9s5q_1",ne="_notice_o9s5q_17",re="_recall_o9s5q_29",x={unloaded:ae,notice:ne,recall:re},oe=()=>{const{setRecall:s}=d(_(a=>({setRecall:a.setRecall})));return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:x.unloaded,children:"Машина разгружена."}),e.jsxs("div",{className:x.notice,children:[e.jsx("strong",{children:"Если на самом деле вы ещё не разгрузились, "}),"обратитесь за помощью на КПП. Ошибка может произойти, если вы не успели подъехать к воротам или из-за сбоя в системе очереди."]}),e.jsxs("div",{className:x.recall,children:[e.jsx("button",{onClick:()=>s("active"),children:"Оставить отзыв"}),e.jsx("p",{children:"Всё прошло гладко или вы столкнулись с проблемами? Мы изучаем ваши ответы, чтобы улучшать нашу систему."})]})]})},ce="_info_1xm6r_1",ie="_row_1xm6r_25",le="_rowTitle_1xm6r_49",de="_pushButton_1xm6r_57",u={info:ce,row:ie,rowTitle:le,pushButton:de},_e=()=>{const{carData:s,toggleModalVisible:a,setModalType:r}=d(_(o=>({carData:o.carData,toggleModalVisible:o.toggleModalVisible,setModalType:o.setModalType}))),{t}=p(),c=()=>{a(),r("notices")};return e.jsxs("div",{className:u.info,children:[e.jsxs("div",{className:u.row,children:[e.jsx("p",{className:u.rowTitle,children:t("table-gates")}),e.jsx("p",{children:t("not-assigned")})]}),e.jsxs("div",{className:u.row,children:[e.jsx("p",{className:u.rowTitle,children:t("queue-number")}),e.jsx("p",{children:s.carsQuantity!==null&&s.carsQuantity})]}),e.jsx("div",{className:u.row,children:e.jsx("p",{children:t("not-assigned-notice")})}),e.jsx("button",{className:u.pushButton,onClick:c,children:t("get-notice")})]})},me="_gateNumber_102dx_1",ue="_gateInfo_102dx_17",b={gateNumber:me,gateInfo:ue},ge=()=>{const{carData:s}=d(_(r=>({carData:r.carData}))),{t:a}=p();return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:b.gateNumber,children:["→ ",a("table-gates")," ",s.gateName]}),e.jsx("p",{className:b.gateInfo,children:a("waiting-time")})]})},he=()=>{const{carData:s}=d(_(a=>({carData:a.carData})));return e.jsxs(e.Fragment,{children:[s.statusId===1&&e.jsx(ge,{}),s.statusId===0&&e.jsx(_e,{}),s.statusId===3&&e.jsx(oe,{}),s.statusId<2&&e.jsx(te,{})]})},xe="_unloaded_j5ts0_1",pe={unloaded:xe},je=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:pe.unloaded,children:"Спасибо!"}),e.jsx("p",{children:"Ваш отзыв принят."})]}),we=()=>{const{isRecall:s,carData:a,setRecall:r,setHouseData:t,setCarData:c,setGatesCoordinates:o,fetchCarData:n}=d(_(l=>({isRecall:l.isRecall,carData:l.carData,setRecall:l.setRecall,setGatesCoordinates:l.setGatesCoordinates,setCarData:l.setCarData,setHouseData:l.setHouseData,fetchCarData:l.fetchCarData}))),{number:i}=C();return h.useEffect(()=>(i&&(n(i),r("disabled"),window.scrollTo({top:0})),()=>{o({x:-100,y:-100}),c(void 0),t(null)}),[i,n,c,o,t,r]),v(),e.jsx(R,{children:a?e.jsxs("div",{className:j.wrapper,children:[e.jsx("p",{className:j.carNumber,children:I(a.carNumber)}),s==="active"&&e.jsx(K,{}),s==="disabled"&&e.jsx(he,{}),s==="sent"&&e.jsx(je,{})]}):e.jsx(k,{})})};export{we as default};
//# sourceMappingURL=car-page-83Rg758R.js.map
