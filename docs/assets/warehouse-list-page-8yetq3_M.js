import{a as d,b as p,j as s,L as w,r as u}from"./index-16h3LCq0.js";import{u as f,c as v,f as j,a as b,L as y}from"./use-analitics-AumvWiRA.js";import{s as N,f as L,L as V}from"./utils-TfEhKhf5.js";const T="_row_1g1zy_1",H="_title__row_1g1zy_13",z="_car__number_1g1zy_29",E="_car__quantity_1g1zy_43",S="_gate__number_1g1zy_57",q="_highlighted_1g1zy_69",A="_gate__notAssigned_1g1zy_79",$="_tj__notAssigned_1g1zy_79",h={row:T,title__row:H,car__number:z,car__quantity:E,gate__number:S,highlighted:q,gate__notAssigned:A,tj__notAssigned:$},k=({carData:r})=>{const{searchValue:e}=d(p(n=>({searchValue:n.searchValue}))),{t:o,translation:c}=f(),t=N(r.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(w,{to:`/${r.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:h.row,children:[s.jsxs("div",{className:h.car__number,children:[r.carsQuantity!==null&&s.jsx("span",{className:h.car__quantity,children:`${r.carsQuantity}.`}),t.map((n,i)=>s.jsxs(u.Fragment,{children:[i===1?s.jsx("span",{className:h.highlighted,children:e}):i>0&&e,n]},i))]}),r.gateName?s.jsxs("div",{className:h.gate__number,children:["â†’ ",r.gateName]}):s.jsx("div",{className:c!=="tj"?h.gate__notAssigned:h.tj__notAssigned,children:o("wait")})]},r.carsQuantity)})})},D=r=>{u.useEffect(()=>{if(r.current){const e=r.current,o=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",o),()=>{e&&e.removeEventListener("scroll",o)}}},[r])},F=()=>{const{setBlur:r,setHeight:e,setTop:o,setTranslate:c}=d(p(t=>({focus:t.focus,blur:t.blur,setBlur:t.setBlur,setHeight:t.setHeight,setTop:t.setTop,setTranslate:t.setTranslate})));u.useEffect(()=>{let t=!1;const n=()=>{console.log("works"),!t&&(t=!0,requestAnimationFrame(()=>{t=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e(`${Math.max(0,window.visualViewport.height)}px`),o(window.visualViewport.offsetTop),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",n),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",n)}},[e,c,r,o])},C=()=>{const{focus:r}=d(p(e=>({focus:e.focus})));u.useEffect(()=>{var o,c;const e=t=>{t.preventDefault()};return r&&((o=document.querySelector("header"))==null||o.addEventListener("touchmove",e),(c=document.querySelector("#search"))==null||c.addEventListener("touchmove",e)),()=>{var t,n;(t=document.querySelector("header"))==null||t.removeEventListener("touchmove",e),(n=document.querySelector("#search"))==null||n.removeEventListener("touchmove",e)}},[r])},B="_content__wrapper_x83fh_1",M="_column__wrapper_x83fh_13",R="_column_x83fh_13",O="_row_x83fh_59",Q="_title__row_x83fh_69",P="_result__wrapper_x83fh_105",W="_one_x83fh_117",U="_result__btn_x83fh_141",_={content__wrapper:B,column__wrapper:M,column:R,row:O,title__row:Q,result__wrapper:P,one:W,result__btn:U},G=()=>{var g;const{t:r}=f(),e=u.useRef(null),{overflow:o,focus:c,houseData:t,searchValue:n,setOverflow:i}=d(p(a=>({houseData:a.houseData,searchValue:a.searchValue,focus:a.focus,overflow:a.overflow,setOverflow:a.setOverflow}))),l=u.useMemo(()=>L(t,n),[t,n]),x=l&&((g=l[0])==null?void 0:g.carNumber.toLowerCase());return u.useEffect(()=>{i("hidden"),setTimeout(()=>{var a;i("auto"),e.current&&((a=e.current)==null||a.scrollTo({top:2}))},0)},[c,n,i]),D(e),F(),C(),s.jsx(s.Fragment,{children:s.jsx("div",{className:_.content__wrapper,children:s.jsx("div",{ref:e,style:{overflow:o},className:_.column__wrapper,children:s.jsxs("div",{onClick:a=>a.stopPropagation(),className:_.column,children:[s.jsxs("div",{className:v(_.title__row,_.row),children:[s.jsx("div",{children:r("table-number")}),s.jsx("div",{children:r("table-gates")})]}),l&&l.map(a=>s.jsx(k,{carData:a},a.carNumber)),l&&l.length===1?s.jsxs("div",{className:c?_.result__wrapper:v(_.result__wrapper,_.one),children:[s.jsx("button",{onMouseDown:a=>a.preventDefault(),className:_.result__btn,children:s.jsx(w,{to:`/${x}`,children:r("search-finded")})}),s.jsx("div",{children:r("search-not-finded")})]}):s.jsx("div",{children:r("search-not-finded")})]})})})})},I="_search__wrapper_9zdkb_1",J="_search__input_9zdkb_35",K="_highlighted_9zdkb_65",X="_search__info_9zdkb_73",m={search__wrapper:I,search__input:J,highlighted:K,search__info:X},Y=r=>{const{query:e}=r,{t:o}=f(),{searchValue:c,setSearchValue:t,focusHandler:n,blurHandler:i}=d(p(l=>({searchValue:l.searchValue,focusHandler:l.focusHandler,blurHandler:l.blurHandler,setSearchValue:l.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:m.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:o("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:m.search__input,value:c,onInput:t,onFocus:n,onBlur:i}),s.jsx("p",{className:m.search__info,children:o("search-notice")}),s.jsx(w,{className:m.search__link,to:`/${e==null?void 0:e.query}/schema`,children:o("search-question")})]})})},Z="_wrapper_veuw4_1",ee={wrapper:Z},oe=()=>{const{houseData:r,fetchHouseData:e}=d(p(c=>({houseData:c.houseData,fetchHouseData:c.fetchHouseData}))),o=j(r);return u.useEffect(()=>{o&&e(o),window.scrollTo({top:0})},[e,o]),b(),s.jsx(y,{children:r&&r.length>=0?s.jsxs("div",{className:ee.wrapper,children:[s.jsx(G,{}),s.jsx(Y,{query:o})]}):s.jsx(V,{})})};export{oe as default};
