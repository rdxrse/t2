import{a as d,b as _,j as e,r as h,w,c as C}from"./index-JIrHwwen.js";import{u as p,f as v,a as D,L as R}from"./use-analitics-1jhc2os7.js";import{e as I,L as k}from"./utils-c5BdE0Hj.js";import{f as G}from"./find-img-n0ZFBaiA.js";const $="_wrapper_5dfp2_1",F="_carNumber_5dfp2_11",j={wrapper:$,carNumber:F},S=["Поставку отказались принимать  ","Не успел подъехать на ворота","Пришлось долго ждать в очереди","Ворота были заняты","Приёмщик требовал взятку"],T=["Быстро подошла очередь","Быстро разгрузили","Вежливый приемщик"],L={bad:S,good:T,"":[]},H="_rating__items_1rsen_1",z="_rating__item_1rsen_1",E="_unloaded_1rsen_103",q="_rating__field_1rsen_119",M="_rating__validate_1rsen_121",B="_rating__require_1rsen_173",V="_rating__button_1rsen_183",m={rating__items:H,rating__item:z,unloaded:E,rating__field:q,rating__validate:M,rating__require:B,rating__button:V},P=()=>{const{ratingType:a,ratingItems:t,setRecall:r,setRatingItems:s}=d(_(n=>({ratingType:n.ratingType,ratingItems:n.ratingItems,setRecall:n.setRecall,setRatingItems:n.setRatingItems}))),c=n=>!!t.find(i=>i==n+1),o=n=>{n.target.checked?s([...t,Number(n.target.id)+1]):s(t.filter(i=>i!==Number(n.target.id)+1))};return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:m.unloaded,children:a==="bad"?"Что было плохо?":"Что было хорошо?"}),e.jsx("form",{className:m.rating__items,children:L[a].map((n,i)=>e.jsxs("div",{className:m.rating__item,children:[e.jsx("input",{checked:c(i),onChange:o,id:`${i}`,type:"checkbox"}),e.jsx("label",{htmlFor:`${i}`,children:n}),e.jsx("span",{children:"✓"})]},i))}),e.jsx("textarea",{className:m.rating__field,placeholder:"Дополнения, если есть,что добавить"}),e.jsx("p",{className:m.unloaded,children:"Для порядка"}),e.jsx("input",{className:m.rating__validate,placeholder:"Номер поставки или ФИО"}),e.jsx("p",{className:m.rating__require,children:"Введите номер поставкиили ФИО полностью, чтобы мы могли убедиться, что отзыв настоящий"}),e.jsx("button",{onClick:()=>r("sent"),className:m.rating__button,children:"Отправить"})]})},Q="_rating__stars_175na_1",W={rating__stars:Q},A=()=>{const{changeStars:a}=d(_(t=>({changeStars:t.changeStars})));return e.jsxs("form",{onChange:a,className:W.rating__stars,children:[e.jsx("input",{id:"star-5",type:"radio",name:"stars",value:"5"}),e.jsx("label",{htmlFor:"star-5"}),e.jsx("input",{id:"star-4",type:"radio",name:"stars",value:"4"}),e.jsx("label",{htmlFor:"star-4"}),e.jsx("input",{id:"star-3",type:"radio",name:"stars",value:"3"}),e.jsx("label",{htmlFor:"star-3"}),e.jsx("input",{id:"star-2",type:"radio",name:"stars",value:"2"}),e.jsx("label",{htmlFor:"star-2"}),e.jsx("input",{id:"star-1",type:"radio",name:"stars",value:"1"}),e.jsx("label",{htmlFor:"star-1"})]})},U="_unloaded_1y99i_1",J="_unchosen_1y99i_15",f={unloaded:U,unchosen:J},K=()=>{const{stars:a,setStars:t,setRecall:r}=d(_(s=>({stars:s.stars,setStars:s.setStars,setRecall:s.setRecall})));return h.useEffect(()=>()=>{t(0)},[t,r]),e.jsxs(e.Fragment,{children:[e.jsx("p",{className:f.unloaded,children:"Как прошла разгрузка?"}),e.jsx(A,{}),a?e.jsx(P,{}):e.jsx("div",{className:f.unchosen,children:"Оцените, а потом добавите детали, если захотите"})]})},b=(a,t=1)=>{var c;const s=(c=w.find(o=>a.warehouseName.toLowerCase().includes(o.name.toLowerCase())).gates)==null?void 0:c.find(o=>o.from.n<=Number(a.gateName)&&o.to.n>=Number(a.gateName));if(s){const o=(s.from.x+(s.to.x-s.from.x)*(Number(a.gateName)-s.from.n)/(s.to.n-s.from.n)-20)*t,n=(s.from.y+(s.to.y-s.from.y)*(Number(a.gateName)-s.from.n)/(s.to.n-s.from.n)-20)*t;return{x:o,y:n}}else return{x:-100,y:-100}},O=()=>{const{carData:a,setGatesCoordinates:t}=d(_(s=>({carData:s.carData,setGatesCoordinates:s.setGatesCoordinates}))),r=h.useRef(null);return h.useEffect(()=>{const s=()=>{if(a&&r.current){const c=r.current;t(b(a,c.width/393))}};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[a,t]),r},X="_schema_1kp9o_1",Y="_schema__text_1kp9o_9",Z="_schema__img_1kp9o_23",ee="_schema__point_1kp9o_55",se="_notice_1kp9o_73",g={schema:X,schema__text:Y,schema__img:Z,schema__point:ee,notice:se},ae=()=>{const{carData:a,gatesCoordinates:t,setGatesCoordinates:r}=d(_(l=>({carData:l.carData,gatesCoordinates:l.gatesCoordinates,setGatesCoordinates:l.setGatesCoordinates}))),{t:s}=p(),c=v(a),o=c&&G(c),n=O(),i=l=>{const y=l.target;a&&r(b(a,y.width/393))};return e.jsxs("div",{className:g.schema,children:[e.jsx("p",{className:g.schema__text,children:s("where-are-gates")}),e.jsxs("div",{className:g.schema__img,children:[e.jsx("img",{alt:a.carNumber,onLoad:i,ref:n,src:o}),e.jsx("span",{className:g.schema__point,style:{display:t.y===-100?"none":"block",top:t.y,left:t.x}})]}),a.gateName&&e.jsxs("div",{className:g.notice,children:[e.jsx("strong",{children:s("notice-strong")}),s("notice-normal")]})]})},te="_unloaded_yvzr9_1",ne="_notice_yvzr9_17",re="_recall_yvzr9_29",x={unloaded:te,notice:ne,recall:re},oe=()=>{const{setRecall:a}=d(_(t=>({setRecall:t.setRecall})));return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:x.unloaded,children:"Машина разгружена."}),e.jsxs("div",{className:x.notice,children:[e.jsx("strong",{children:"Если на самом деле вы ещё не разгрузились, "}),"обратитесь за помощью на КПП. Ошибка может произойти, если вы не успели подъехать к воротам или из-за сбоя в системе очереди."]}),e.jsxs("div",{className:x.recall,children:[e.jsx("button",{onClick:()=>a("active"),children:"Оставить отзыв"}),e.jsx("p",{children:"Всё прошло гладко или вы столкнулись с проблемами? Мы изучаем ваши ответы, чтобы улучшать нашу систему."})]})]})},ce="_info_1xm6r_1",ie="_row_1xm6r_25",le="_rowTitle_1xm6r_49",de="_pushButton_1xm6r_57",u={info:ce,row:ie,rowTitle:le,pushButton:de},_e=()=>{const{carData:a,toggleModalVisible:t,setModalType:r}=d(_(o=>({carData:o.carData,toggleModalVisible:o.toggleModalVisible,setModalType:o.setModalType}))),{t:s}=p(),c=()=>{t(),r("notices")};return e.jsxs("div",{className:u.info,children:[e.jsxs("div",{className:u.row,children:[e.jsx("p",{className:u.rowTitle,children:s("table-gates")}),e.jsx("p",{children:s("not-assigned")})]}),e.jsxs("div",{className:u.row,children:[e.jsx("p",{className:u.rowTitle,children:s("queue-number")}),e.jsx("p",{children:a.carsQuantity!==null&&a.carsQuantity})]}),e.jsx("div",{className:u.row,children:e.jsx("p",{children:s("not-assigned-notice")})}),e.jsx("button",{className:u.pushButton,onClick:c,children:s("get-notice")})]})},me="_gateNumber_102dx_1",ue="_gateInfo_102dx_17",N={gateNumber:me,gateInfo:ue},ge=()=>{const{carData:a}=d(_(r=>({carData:r.carData}))),{t}=p();return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:N.gateNumber,children:["→ ",t("table-gates")," ",a.gateName]}),e.jsx("p",{className:N.gateInfo,children:t("waiting-time")})]})},he=()=>{const{carData:a}=d(_(t=>({carData:t.carData})));return e.jsxs(e.Fragment,{children:[a.statusId===1&&e.jsx(ge,{}),a.statusId===0&&e.jsx(_e,{}),a.statusId===3&&e.jsx(oe,{}),a.statusId<2&&e.jsx(ae,{})]})},xe="_unloaded_j5ts0_1",pe={unloaded:xe},je=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:pe.unloaded,children:"Спасибо!"}),e.jsx("p",{children:"Ваш отзыв принят."})]}),we=()=>{const{isRecall:a,carData:t,setRecall:r,setHouseData:s,setCarData:c,setGatesCoordinates:o,fetchCarData:n}=d(_(l=>({isRecall:l.isRecall,carData:l.carData,setRecall:l.setRecall,setGatesCoordinates:l.setGatesCoordinates,setCarData:l.setCarData,setHouseData:l.setHouseData,fetchCarData:l.fetchCarData}))),{number:i}=C();return h.useEffect(()=>(i&&(n(i),r("disabled"),window.scrollTo({top:0})),()=>{o({x:-100,y:-100}),c(void 0),s(null)}),[i,n,c,o,s,r]),D(),e.jsx(R,{children:t?e.jsxs("div",{className:j.wrapper,children:[e.jsx("p",{className:j.carNumber,children:I(t.carNumber)}),a==="active"&&e.jsx(K,{}),a==="disabled"&&e.jsx(he,{}),a==="sent"&&e.jsx(je,{})]}):e.jsx(k,{})})};export{we as default};
