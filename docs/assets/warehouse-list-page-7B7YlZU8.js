import{a as p,b as m,j as s,L as f,r as _}from"./index-zFujjTPV.js";import{u as g,c as x,f as b,a as y,L as N}from"./use-analitics-hVHl8lDg.js";import{s as L,f as V,L as T}from"./utils-C5VJsneC.js";const H="_row_1g1zy_1",z="_title__row_1g1zy_13",E="_car__number_1g1zy_29",S="_car__quantity_1g1zy_43",q="_gate__number_1g1zy_57",A="_highlighted_1g1zy_69",$="_gate__notAssigned_1g1zy_79",k="_tj__notAssigned_1g1zy_79",h={row:H,title__row:z,car__number:E,car__quantity:S,gate__number:q,highlighted:A,gate__notAssigned:$,tj__notAssigned:k},D=({carData:t})=>{const{searchValue:e}=p(m(a=>({searchValue:a.searchValue}))),{t:r,translation:c}=g(),o=L(t.carNumber,e);return console.log("render item"),s.jsx(s.Fragment,{children:s.jsx(f,{to:`/${t.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:h.row,children:[s.jsxs("div",{className:h.car__number,children:[t.carsQuantity!==null&&s.jsx("span",{className:h.car__quantity,children:`${t.carsQuantity}.`}),o.map((a,l)=>s.jsxs(_.Fragment,{children:[l===1?s.jsx("span",{className:h.highlighted,children:e}):l>0&&e,a]},l))]}),t.gateName?s.jsxs("div",{className:h.gate__number,children:["â†’ ",t.gateName]}):s.jsx("div",{className:c!=="tj"?h.gate__notAssigned:h.tj__notAssigned,children:r("wait")})]},t.carsQuantity)})})},F=t=>{_.useEffect(()=>{if(t.current){const e=t.current,r=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",r),()=>{e&&e.removeEventListener("scroll",r)}}},[t])},C=()=>{const{setBlur:t,setHeight:e,setTop:r,setTranslate:c}=p(m(o=>({focus:o.focus,blur:o.blur,setBlur:o.setBlur,setHeight:o.setHeight,setTop:o.setTop,setTranslate:o.setTranslate})));_.useEffect(()=>{let o=!1;const a=()=>{o||(o=!0,requestAnimationFrame(()=>{o=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e(`${Math.max(0,window.visualViewport.height)}px`),r(window.visualViewport.offsetTop),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",a),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",a),e("100%"))}},[e,c,t,r])},B=()=>{const{focus:t}=p(m(e=>({focus:e.focus})));_.useEffect(()=>{var r,c;const e=o=>{o.preventDefault()};return t&&((r=document.querySelector("header"))==null||r.addEventListener("touchmove",e),(c=document.querySelector("#search"))==null||c.addEventListener("touchmove",e)),()=>{var o,a;(o=document.querySelector("header"))==null||o.removeEventListener("touchmove",e),(a=document.querySelector("#search"))==null||a.removeEventListener("touchmove",e)}},[t])},M="_content__wrapper_x83fh_1",R="_column__wrapper_x83fh_13",O="_column_x83fh_13",Q="_row_x83fh_59",P="_title__row_x83fh_69",W="_result__wrapper_x83fh_105",U="_one_x83fh_117",G="_result__btn_x83fh_141",i={content__wrapper:M,column__wrapper:R,column:O,row:Q,title__row:P,result__wrapper:W,one:U,result__btn:G},I=_.memo(function(){var v;const{t:e}=g(),r=_.useRef(null),{overflow:c,focus:o,houseData:a,searchValue:l,setOverflow:u}=p(m(n=>({houseData:n.houseData,searchValue:n.searchValue,focus:n.focus,overflow:n.overflow,setOverflow:n.setOverflow}))),d=_.useMemo(()=>V(a,l),[a,l]),j=d&&((v=d[0])==null?void 0:v.carNumber.toLowerCase());return _.useEffect(()=>{u("hidden"),setTimeout(()=>{var n;u("auto"),r.current&&((n=r.current)==null||n.scrollTo({top:2}))},0)},[o,l,u]),F(r),C(),B(),s.jsx(s.Fragment,{children:s.jsx("div",{className:i.content__wrapper,children:s.jsx("div",{ref:r,style:{overflow:c},className:i.column__wrapper,children:s.jsxs("div",{onClick:n=>n.stopPropagation(),className:i.column,children:[s.jsxs("div",{className:x(i.title__row,i.row),children:[s.jsx("div",{children:e("table-number")}),s.jsx("div",{children:e("table-gates")})]}),d&&d.map(n=>s.jsx(D,{carData:n},n.carNumber)),d&&d.length===1?s.jsxs("div",{className:o?i.result__wrapper:x(i.result__wrapper,i.one),children:[s.jsx("button",{onMouseDown:n=>n.preventDefault(),className:i.result__btn,children:s.jsx(f,{to:`/${j}`,children:e("search-finded")})}),s.jsx("div",{children:e("search-not-finded")})]}):s.jsx("div",{children:e("search-not-finded")})]})})})})}),J="_search__wrapper_9zdkb_1",K="_search__input_9zdkb_35",X="_highlighted_9zdkb_65",Y="_search__info_9zdkb_73",w={search__wrapper:J,search__input:K,highlighted:X,search__info:Y},Z=t=>{const{query:e}=t,{t:r}=g(),{searchValue:c,setSearchValue:o,focusHandler:a,blurHandler:l}=p(m(u=>({searchValue:u.searchValue,focusHandler:u.focusHandler,blurHandler:u.blurHandler,setSearchValue:u.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:w.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:r("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:w.search__input,value:c,onInput:o,onFocus:a,onBlur:l}),s.jsx("p",{className:w.search__info,children:r("search-notice")}),s.jsx(f,{className:w.search__link,to:`/${e==null?void 0:e.query}/schema`,children:r("search-question")})]})})},ee="_wrapper_veuw4_1",se={wrapper:ee},ne=()=>{const{houseData:t,fetchHouseData:e}=p(m(c=>({houseData:c.houseData,fetchHouseData:c.fetchHouseData}))),r=b(t);return _.useEffect(()=>{r&&e(r),window.scrollTo({top:0})},[e,r]),y(),s.jsx(N,{children:t&&t.length>=0?s.jsxs("div",{className:se.wrapper,children:[s.jsx(I,{}),s.jsx(Z,{query:r})]}):s.jsx(T,{})})};export{ne as default};
