import{a as d,b as p,j as s,L as f,r as h}from"./index-6rf9y3DD.js";import{u as w,c as v,f as j,a as b,L as y}from"./use-analitics-GDHGjfn_.js";import{s as N,f as L,L as V}from"./utils-p1vvlYPc.js";const T="_row_1g1zy_1",H="_title__row_1g1zy_13",z="_car__number_1g1zy_29",E="_car__quantity_1g1zy_43",S="_gate__number_1g1zy_57",q="_highlighted_1g1zy_69",A="_gate__notAssigned_1g1zy_79",$="_tj__notAssigned_1g1zy_79",u={row:T,title__row:H,car__number:z,car__quantity:E,gate__number:S,highlighted:q,gate__notAssigned:A,tj__notAssigned:$},k=({carData:r})=>{const{searchValue:e}=d(p(a=>({searchValue:a.searchValue}))),{t,translation:n}=w(),i=N(r.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(f,{to:`/${r.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:u.row,children:[s.jsxs("div",{className:u.car__number,children:[r.carsQuantity!==null&&s.jsx("span",{className:u.car__quantity,children:`${r.carsQuantity}.`}),i.map((a,o)=>s.jsxs(h.Fragment,{children:[o===1?s.jsx("span",{className:u.highlighted,children:e}):o>0&&e,a]},o))]}),r.gateName?s.jsxs("div",{className:u.gate__number,children:["â†’ ",r.gateName]}):s.jsx("div",{className:n!=="tj"?u.gate__notAssigned:u.tj__notAssigned,children:t("wait")})]},r.carsQuantity)})})},D=r=>{h.useEffect(()=>{if(r.current){const e=r.current,t=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",t),()=>{e&&e.removeEventListener("scroll",t)}}},[r])},F=()=>{const{focus:r,blur:e,setBlur:t,setHeight:n,setTop:i,setTranslate:a}=d(p(o=>({focus:o.focus,blur:o.blur,setBlur:o.setBlur,setHeight:o.setHeight,setTop:o.setTop,setTranslate:o.setTranslate})));h.useEffect(()=>{let o=!1;const l=()=>{o||(o=!0,requestAnimationFrame(()=>{o=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e&&!r?(n("100%"),a(""),t(!1)):(n(`${Math.max(0,window.visualViewport.height)}px`),i(window.visualViewport.offsetTop)),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",l),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",l),n("100%"),a(""))}},[n,a,t,e,r,i])},C=()=>{const{focus:r}=d(p(e=>({focus:e.focus})));h.useEffect(()=>{var t,n;const e=i=>{i.preventDefault()};return r&&((t=document.querySelector("header"))==null||t.addEventListener("touchmove",e),(n=document.querySelector("#search"))==null||n.addEventListener("touchmove",e)),()=>{var i,a;(i=document.querySelector("header"))==null||i.removeEventListener("touchmove",e),(a=document.querySelector("#search"))==null||a.removeEventListener("touchmove",e)}},[r])},B="_content__wrapper_x83fh_1",R="_column__wrapper_x83fh_13",M="_column_x83fh_13",O="_row_x83fh_59",Q="_title__row_x83fh_69",P="_result__wrapper_x83fh_105",W="_one_x83fh_117",U="_result__btn_x83fh_141",_={content__wrapper:B,column__wrapper:R,column:M,row:O,title__row:Q,result__wrapper:P,one:W,result__btn:U},G=()=>{var g;const{t:r}=w(),e=h.useRef(null),{overflow:t,focus:n,houseData:i,searchValue:a,setOverflow:o}=d(p(c=>({houseData:c.houseData,searchValue:c.searchValue,focus:c.focus,overflow:c.overflow,setOverflow:c.setOverflow}))),l=L(i,a),x=l&&((g=l[0])==null?void 0:g.carNumber.toLowerCase());return h.useEffect(()=>{o("hidden"),setTimeout(()=>{var c;o("auto"),e.current&&((c=e.current)==null||c.scrollTo({top:2}))},0)},[n,a,o]),D(e),F(),C(),s.jsx(s.Fragment,{children:s.jsx("div",{className:_.content__wrapper,children:s.jsx("div",{ref:e,style:{overflow:t},className:_.column__wrapper,children:s.jsxs("div",{onClick:c=>c.stopPropagation(),className:_.column,children:[s.jsxs("div",{className:v(_.title__row,_.row),children:[s.jsx("div",{children:r("table-number")}),s.jsx("div",{children:r("table-gates")})]}),l&&l.map(c=>s.jsx(k,{carData:c},c.carNumber)),l&&l.length===1?s.jsxs("div",{className:n?_.result__wrapper:v(_.result__wrapper,_.one),children:[s.jsx("button",{onMouseDown:c=>c.preventDefault(),className:_.result__btn,children:s.jsx(f,{to:`/${x}`,children:r("search-finded")})}),s.jsx("div",{children:r("search-not-finded")})]}):s.jsx("div",{children:r("search-not-finded")})]})})})})},I="_search__wrapper_9zdkb_1",J="_search__input_9zdkb_35",K="_highlighted_9zdkb_65",X="_search__info_9zdkb_73",m={search__wrapper:I,search__input:J,highlighted:K,search__info:X},Y=r=>{const{query:e}=r,{t}=w(),{searchValue:n,setSearchValue:i,focusHandler:a,blurHandler:o}=d(p(l=>({searchValue:l.searchValue,focusHandler:l.focusHandler,blurHandler:l.blurHandler,setSearchValue:l.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:m.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:t("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:m.search__input,value:n,onInput:i,onFocus:a,onBlur:o}),s.jsx("p",{className:m.search__info,children:t("search-notice")}),s.jsx(f,{className:m.search__link,to:`/${e==null?void 0:e.query}/schema`,children:t("search-question")})]})})},Z="_wrapper_veuw4_1",ee={wrapper:Z},oe=()=>{const{houseData:r,fetchHouseData:e}=d(p(n=>({houseData:n.houseData,fetchHouseData:n.fetchHouseData}))),t=j(r);return h.useEffect(()=>{t&&e(t),window.scrollTo({top:0})},[e,t]),b(),s.jsx(y,{children:r&&r.length>=0?s.jsxs("div",{className:ee.wrapper,children:[s.jsx(G,{}),s.jsx(Y,{query:t})]}):s.jsx(V,{})})};export{oe as default};
